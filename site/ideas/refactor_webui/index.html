
<!doctype html>
<html lang="en" class="no-js">
  <head>

      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">









      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">



        <title>Refactor webui - Meraki Home Assistant Integration</title>



      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">












        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>



    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>





  </head>


    <body dir="ltr">


    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">

    </div>
    <div data-md-component="announce">

    </div>






<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Meraki Home Assistant Integration" class="md-header__button md-logo" aria-label="Meraki Home Assistant Integration" data-md-component="logo">


  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">

      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Meraki Home Assistant Integration
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">

              Refactor webui

          </span>
        </div>
      </div>
    </div>


      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>





        <label class="md-header__button md-icon" for="__search">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">

        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>

    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>



  </nav>

</header>

    <div class="md-container" data-md-component="container">






      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">



              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Meraki Home Assistant Integration" class="md-nav__button md-logo" aria-label="Meraki Home Assistant Integration" data-md-component="logo">


  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Meraki Home Assistant Integration
  </label>

  <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">



  <span class="md-ellipsis">


    Home



  </span>



      </a>
    </li>














    <li class="md-nav__item md-nav__item--nested">



        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >


          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">



  <span class="md-ellipsis">


    User Guide



  </span>



            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>


    User Guide


          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../user/setup/" class="md-nav__link">



  <span class="md-ellipsis">


    Setup



  </span>



      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../user/entities/" class="md-nav__link">



  <span class="md-ellipsis">


    Entities



  </span>



      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../user/troubleshooting/" class="md-nav__link">



  <span class="md-ellipsis">


    Troubleshooting



  </span>



      </a>
    </li>




          </ul>
        </nav>

    </li>














    <li class="md-nav__item md-nav__item--nested">



        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >


          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">



  <span class="md-ellipsis">


    Developer Guide



  </span>



            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>


    Developer Guide


          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../internal/architecture/" class="md-nav__link">



  <span class="md-ellipsis">


    Architecture



  </span>



      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../internal/testing/TEST_SERVER/" class="md-nav__link">



  <span class="md-ellipsis">


    Testing



  </span>



      </a>
    </li>




          </ul>
        </nav>

    </li>



  </ul>
</nav>
                  </div>
                </div>
              </div>



              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">




</nav>
                  </div>
                </div>
              </div>



            <div class="md-content" data-md-component="content">

              <article class="md-content__inner md-typeset">





  <h1>Refactor webui</h1>

<p>*<strong>*AI Agent Instructions</strong></p>
<p><strong>Persona:</strong> A senior product manager with a deep understanding of user experience and system architecture.</p>
<p><strong>Objective:</strong> The primary objective is to transform the integration's web UI from a simple static view into a dynamic, informative dashboard. The goal is to surface a complete, real-time overview of the Meraki network's status and health. The UI should preemptively answer a user's questions by displaying critical information—such as device discovery, entity status, and potential issues—that currently resides in backend logs.</p>
<p><strong>Core Principles to Guide Implementation:</strong></p>
<ol>
<li><strong>Dashboard First:</strong> The initial view must be a high-level dashboard. It should provide a quick, at-a-glance summary of the entire organization, including key counts (e.g., number of wireless devices, switches, cameras) and any critical alerts.</li>
<li><strong>Drill-Down Capability:</strong> The user must be able to click on any summary metric or a specific device to access a detailed view. This detailed view will contain all relevant information for that specific device or entity, including its associated sensors, switches, and any logged status messages.</li>
<li><strong>Proactive Communication:</strong> The UI should move beyond showing what <em>is</em> and begin explaining <em>why</em>. For example, instead of just showing that an RTSP stream is unavailable, it should display the specific reason logged in the backend. This is the core value-add for the user.</li>
<li><strong>Modern UI/UX:</strong> The interface must be a modern web application. It should be fully responsive, work seamlessly on both mobile and desktop, and automatically adapt to the user's browser theme (light/dark mode). All components should be reusable and adhere to a clean, consistent design language.</li>
<li><strong>State-Driven Interface:</strong> The UI should not poll the API directly. It must be a passive consumer of a live data feed from the Home Assistant backend. This will ensure a performant and efficient user experience.</li>
</ol>
<hr />
<p>*<strong>*Architecture &amp; Design Instructions</strong></p>
<p>The UI will be a single-page application (SPA) built using <strong>React</strong> for its component-based architecture and state management capabilities, with <strong>Tailwind CSS</strong> for a utility-first approach to styling.</p>
<ul>
<li><strong>Data Model:</strong> The Home Assistant integration will expose a dedicated WebSocket API endpoint that serves a centralized data payload. This payload will contain counts for all device types, a list of all discovered entities with their properties (device info, type, status), and a new field for <code>status_messages</code> on each device. This new field will hold the valuable, human-readable information from the logs.</li>
<li><strong>Component Hierarchy:</strong></li>
<li><strong><code>App.tsx</code> (Main Component):</strong> Manages the primary application state (e.g., <code>loading</code>, <code>data</code>, <code>activeView</code>). It establishes the WebSocket connection and handles client-side routing.</li>
<li><strong><code>Dashboard.tsx</code>:</strong> Displays the high-level metrics using <code>StatusCard</code> components and a summary table of devices.</li>
<li><strong><code>DeviceView.tsx</code>:</strong> Displays detailed information for a single device, including its metadata and a list of all associated entities.</li>
<li><strong><code>StatusCard.tsx</code>:</strong> A reusable component to show a single metric with a title, a value, and an icon. This promotes a consistent look and feel across the dashboard.</li>
<li><strong><code>DeviceTable.tsx</code>:</strong> A searchable, sortable component to list all discovered Meraki devices.</li>
<li><strong>Styling:</strong> Tailwind's <code>dark:</code> modifier will be used exclusively for dark mode. All styling will be done with Tailwind classes to ensure full responsiveness and a clean, modern aesthetic. The font should be <code>Inter</code> for clarity and a modern feel.</li>
</ul>
<hr />
<p>*<strong>*Detailed Implementation Plan</strong></p>
<p>This plan is a step-by-step guide for an AI agent to build the new UI from scratch.</p>
<p><strong>Phase 1: Backend Data &amp; API</strong></p>
<ol>
<li><strong>Create WebSocket Endpoint:</strong></li>
<li>Create a new file, <code>custom_components/meraki_ha/api/websocket.py</code>.</li>
<li>Define a WebSocket handler that, when a connection is established, immediately sends a complete snapshot of the integration's data from <code>hass.data[DOMAIN][config_entry.entry_id]</code>.</li>
<li>
<p>Implement a state change listener (e.g., using a Home Assistant <code>callback</code>) that pushes updates to all connected WebSocket clients whenever the coordinator's data changes. This ensures the UI is always in sync.</p>
</li>
<li>
<p><strong>Enrich Data with Status Messages:</strong></p>
</li>
<li>Modify the Meraki data coordinator to store a new <code>status_messages</code> list for each device in its data payload.</li>
<li>Whenever an entity or handler logs a significant event (e.g., "Could not retrieve stream..."), instead of just logging a message, it should also add a formatted string to this new <code>status_messages</code> list for the relevant device.</li>
</ol>
<p><strong>Phase 2: Frontend Foundation (React)</strong></p>
<ol>
<li><strong>Set up the React App:</strong></li>
<li>Create a React app in a new folder: <code>custom_components/meraki_ha/www</code>.</li>
<li>Remove all boilerplate code and create a single <code>App.tsx</code> component.</li>
<li><strong>Connect to Backend:</strong></li>
<li>In <code>App.tsx</code>, use a <code>useState</code> hook for <code>data</code>, <code>loading</code>, and <code>error</code>.</li>
<li>In a <code>useEffect</code> hook, establish a WebSocket connection to the Home Assistant endpoint.</li>
<li>On a successful connection and a received message, update the <code>data</code> state. Implement a basic loading indicator (e.g., a spinner or text) while <code>loading</code> is true.</li>
<li><strong>Implement Routing:</strong></li>
<li>Create a simple state-based routing system within <code>App.tsx</code> using a state variable like <code>activeView</code>.</li>
<li>The <code>App.tsx</code> component will conditionally render either the <code>Dashboard</code> component or the <code>DeviceView</code> component based on the <code>activeView</code> state.</li>
</ol>
<p><strong>Phase 3: Dashboard &amp; Core Components</strong></p>
<ol>
<li><strong>Build <code>StatusCard.tsx</code>:</strong></li>
<li>Create this reusable component. It will accept props like <code>title</code>, <code>value</code>, <code>icon</code>, and a <code>onClick</code> handler.</li>
<li>Apply Tailwind classes for styling, including responsive padding and margins. Use the <code>dark:</code> prefix for dark mode styles.</li>
<li><strong>Build <code>Dashboard.tsx</code>:</strong></li>
<li>Use Tailwind's <code>grid-cols-1 md:grid-cols-2 lg:grid-cols-4</code> to create a responsive card layout.</li>
<li>Render an instance of <code>StatusCard</code> for each key metric: "Total Devices," "Wireless APs," "Switches," "Cameras," and "Virtual SSIDs." The values for these cards will come from the <code>data</code> received from the WebSocket.</li>
<li><strong>Build <code>DeviceTable.tsx</code>:</strong></li>
<li>Create a component that renders a table with columns for <strong>Device Name</strong>, <strong>Model</strong>, and <strong>Status</strong>.</li>
<li>Add a search bar at the top to filter the table by device name or serial.</li>
<li>Add a <code>onClick</code> handler to each table row that sets the <code>activeView</code> state in the parent <code>App</code> component to show the device details.</li>
</ol>
<p><strong>Phase 4: Device Details &amp; Final Touches</strong></p>
<ol>
<li><strong>Build <code>DeviceView.tsx</code>:</strong></li>
<li>This component will receive the selected device's data as a prop.</li>
<li>Display key information like <code>name</code>, <code>model</code>, <code>serial</code>, and <code>firmware</code> in a prominent card at the top.</li>
<li>Display the new <code>status_messages</code> list from the device's data payload. Use a unique style (e.g., a red border for warnings) to make them stand out.</li>
<li>Create a list or table of all <code>entities</code> belonging to this device, clearly showing their name, type, and current state.</li>
<li><strong>Implement Dark Mode:</strong></li>
<li>Review all React components and their styling.</li>
<li>For any color or background, ensure you have a <code>dark:</code> prefix class defined (e.g., <code>bg-white dark:bg-gray-800</code>). The browser will handle the rest.</li>
<li><strong>Add Final Polish:</strong></li>
<li>Implement smooth transitions for component changes.</li>
<li>Add an icon for each card in the dashboard.</li>
<li>Ensure the overall layout is centered and has adequate spacing.</li>
</ol>
<p>This implementation plan, guided by the product principles of being proactive and intuitive, will result in a significantly more useful and polished web UI for the Meraki Home Assistant integration.</p>













              </article>
            </div>


<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>

      </main>

        <footer class="md-footer">

  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">


    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>

</div>

    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>





      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>


      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>


  </body>
</html>